{"ast":null,"code":"/*\n * Copyright (c) 2018 by Filestack\n * Some rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport * as tslib_1 from \"tslib\";\nimport { loadModule, knownModuleIds } from 'filestack-loader';\nimport { FilestackError, FilestackErrorType } from './../filestack_error';\nimport { getValidator, PickerParamsSchema } from './../schema';\nexport var RotateDirection;\n\n(function (RotateDirection) {\n  RotateDirection[\"cw\"] = \"CW\";\n  RotateDirection[\"ccw\"] = \"CCW\";\n})(RotateDirection || (RotateDirection = {}));\n\nexport var PickerDisplayMode;\n\n(function (PickerDisplayMode) {\n  PickerDisplayMode[\"inline\"] = \"inline\";\n  PickerDisplayMode[\"overlay\"] = \"overlay\";\n  PickerDisplayMode[\"dropPane\"] = \"dropPane\";\n})(PickerDisplayMode || (PickerDisplayMode = {}));\n/**\n * @private\n * A synchronous-looking wrapper for loading the picker and calling its methods.\n * This is currently needed because the picker module is loaded asynchronously.\n * Eventually we should offer a bundle with the picker module included.\n */\n\n\nvar PickerLoader =\n/** @class */\nfunction () {\n  function PickerLoader(client, options) {\n    var validateRes = getValidator(PickerParamsSchema)(options);\n\n    if (validateRes.errors.length) {\n      throw new FilestackError(\"Invalid picker params\", validateRes.errors, FilestackErrorType.VALIDATION);\n    }\n\n    this._initialized = this.loadModule(client, options);\n  }\n\n  PickerLoader.prototype.open = function () {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var picker;\n      return tslib_1.__generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this._initialized];\n\n          case 1:\n            picker = _a.sent();\n            return [4\n            /*yield*/\n            , picker.open()];\n\n          case 2:\n            _a.sent();\n\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  PickerLoader.prototype.crop = function (files) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var picker;\n      return tslib_1.__generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this._initialized];\n\n          case 1:\n            picker = _a.sent();\n            return [4\n            /*yield*/\n            , picker.crop(files)];\n\n          case 2:\n            _a.sent();\n\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  PickerLoader.prototype.close = function () {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var picker;\n      return tslib_1.__generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this._initialized];\n\n          case 1:\n            picker = _a.sent();\n            return [4\n            /*yield*/\n            , picker.close()];\n\n          case 2:\n            _a.sent();\n\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  PickerLoader.prototype.cancel = function () {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var picker;\n      return tslib_1.__generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4\n            /*yield*/\n            , this._initialized];\n\n          case 1:\n            picker = _a.sent();\n            return [4\n            /*yield*/\n            , picker.cancel()];\n\n          case 2:\n            _a.sent();\n\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n\n  PickerLoader.prototype.loadModule = function (client, options) {\n    return tslib_1.__awaiter(this, void 0, void 0, function () {\n      var url, Picker;\n      return tslib_1.__generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            url = client.session.urls.pickerUrl;\n            return [4\n            /*yield*/\n            , loadModule(url, knownModuleIds.picker)];\n\n          case 1:\n            Picker = _a.sent();\n            return [2\n            /*return*/\n            , new Picker(client, options)];\n        }\n      });\n    });\n  };\n\n  return PickerLoader;\n}();\n/**\n * Loads and creates picker instance\n *\n * @private\n * @param client\n * @param options\n */\n\n\nexport var picker = function (client, options) {\n  return new PickerLoader(client, options);\n};","map":null,"metadata":{},"sourceType":"module"}